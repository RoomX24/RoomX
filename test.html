<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <title>Szoba Felület</title>
  <style>
    body {
      background-color: black;
      color: red;
      font-family: monospace;
      text-align: center;
      padding-top: 50px;
    }
    #countdown {
      font-size: 64px;
      margin-bottom: 40px;
    }
    #tip {
      font-size: 28px;
      background-color: red;
      color: black;
      display: inline-block;
      padding: 10px 20px;
      border-radius: 8px;
      max-width: 80%;
      word-wrap: break-word;
      resize: none;
      overflow: hidden;
      width: 60%;
      height: auto;
      min-height: 40px;
      line-height: 1.5;
    }
    #helpButton {
      padding: 10px;
      background-color: blue;
      color: white;
      border: none;
      font-size: 18px;
      margin-top: 20px;
    }
    #helpCount {
      font-size: 20px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div id="countdown">00:00</div>
  <div id="tip">Tipp: (nincs még megadva)</div>

  <hr>

  <!-- Segítségkérés gomb -->
  <button id="helpButton" onclick="requestHelp()">Segítség Kérés</button>
  <div id="helpCount">Segítség kérések: 3</div>
  <div id="remainingHelp">Maradó segítségkérések: 3</div>

  <script>
    let timerStarted = false; // Az óra állapota
    let helpRequests = 3; // Segítségkérések száma

    // Formázza az időt
    function formatTime(seconds) {
      const m = Math.floor(seconds / 60);
      const s = seconds % 60;
      return `${m}:${s.toString().padStart(2, '0')}`;
    }

    // Frissíti a visszaszámlálót és a tippet
    function updateView() {
      const end = localStorage.getItem("countdownEnd");
      const countdownEl = document.getElementById("countdown");
      if (!end) {
        countdownEl.textContent = "00:00";
      } else {
        const remaining = Math.floor((end - Date.now()) / 1000);
        if (remaining <= 0) {
          countdownEl.textContent = "00:00";
        } else {
          countdownEl.textContent = formatTime(remaining);
        }
      }

      const tip = localStorage.getItem("roomTip");
      const tipEl = document.getElementById("tip");
      if (tip) {
        tipEl.textContent = "Tipp: " + tip;
      } else {
        tipEl.textContent = "Tipp: (nincs még megadva)";
      }

      // Frissíti a segítség kérések számát
      const helpCountEl = document.getElementById("helpCount");
      helpCountEl.textContent = "Segítség kérések: " + helpRequests;

      // Frissíti a maradó segítségkéréseket
      const remainingHelpEl = document.getElementById("remainingHelp");
      remainingHelpEl.textContent = "Maradó segítségkérések: " + helpRequests;
    }

    // Segítségkérés
    function requestHelp() {
      if (helpRequests > 0) {
        alert("Segítséget kértél! (Még " + (helpRequests - 1) + " segítség maradt.)");
        helpRequests--;
        updateView(); // Frissítés
      } else {
        alert("Már nem kérhetsz segítséget!");
      }
    }

    // Óra indítása
    function startTimer() {
      timerStarted = true;
      const countdownEnd = Date.now() + 60 * 60 * 1000; // 1 óra
      localStorage.setItem("countdownEnd", countdownEnd);
      updateView();
      helpRequests = 3; // Segítségkérések számának nullázása
      localStorage.setItem("helpRequests", helpRequests);
    }

    // Frissíti a nézetet minden másodpercben
    setInterval(function() {
      updateView();
    }, 1000);

    updateView();
  </script>
</body>
</html>
